<html lang="zh-CN">

<head>
	<meta charset="utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
	<title>Discord 论坛搜索门户</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link
		href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
		rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
	<script>
		tailwind.config = {
			theme: {
				extend: {
					fontFamily: { sans: ['Inter', 'sans-serif'] },
					colors: {
						discord: {
							bg: '#36393f',
							sidebar: '#2f3136',
							element: '#202225',
							primary: '#5865F2',
							hover: '#4752c4',
							green: '#3ba55c',
							red: '#ed4245',
							text: '#dcddde',
							muted: '#72767d',
							dark: '#18191c'
						}
					},
					transitionTimingFunction: {
						'bounce-in': 'cubic-bezier(0.34, 1.56, 0.64, 1)',
					}
				}
			}
		}
	</script>
	<link rel="stylesheet" href="style.css">
</head>

<body class="bg-discord-bg text-discord-text font-sans h-screen flex overflow-hidden">

	<!-- Sidebar Backdrop (Mobile) -->
	<div class="fixed inset-0 bg-black/70 z-30 hidden md:hidden opacity-0 transition-opacity duration-300"
		id="sidebar-backdrop" onclick="app.toggleSidebar(false)"></div>

	<!-- Mobile Detail Overlay (全局唯一的详情弹窗容器) -->
	<div class="mobile-overlay md:hidden" id="mobile-detail-overlay" onclick="app.closeMobileDetail(event)">
		<div class="mobile-expanded-card" id="mobile-detail-card" onclick="event.stopPropagation()">
			<!-- Content Injected by JS -->
		</div>
	</div>

	<!-- Sidebar -->
	<aside
		class="fixed inset-y-0 left-0 z-40 w-72 bg-discord-sidebar flex flex-col border-r border-black/10 transform -translate-x-full md:translate-x-0 md:static md:w-64 md:flex-shrink-0 shadow-2xl md:shadow-none transition-transform duration-300 ease-in-out"
		id="sidebar">
		<div class="p-4 font-bold text-lg text-white border-b border-black/10 flex items-center justify-between">
			<div class="flex items-center gap-2">
				<span class="material-symbols-outlined text-discord-primary">forum</span>
				<span>论坛门户</span>
			</div>
			<button class="md:hidden text-discord-muted hover:text-white" onclick="app.toggleSidebar(false)">
				<span class="material-symbols-outlined">close</span>
			</button>
		</div>
		<!-- Navigation -->
		<nav class="flex-1 overflow-y-auto p-2 space-y-1">
			<button
				class="w-full flex items-center gap-3 px-3 py-2 rounded hover:bg-discord-element text-white bg-discord-element transition-colors text-left"
				id="nav-search" onclick="app.switchView('search')">
				<span class="material-symbols-outlined text-gray-400">search</span>
				<span>搜索发现</span>
			</button>
			<button
				class="w-full flex items-center gap-3 px-3 py-2 rounded hover:bg-discord-element transition-colors text-left relative text-discord-muted"
				id="nav-follows" onclick="app.switchView('follows')">
				<span class="material-symbols-outlined text-gray-400">bookmarks</span>
				<span>关注列表</span>
				<span
					class="absolute right-2 bg-discord-red text-white text-xs font-bold px-1.5 py-0.5 rounded-full hidden"
					id="sidebar-badge">0</span>
			</button>
			<div id="channel-list-container">
				<!-- Channels will be injected here -->
			</div>
		</nav>
		<!-- User Profile -->
		<div class="p-3 bg-discord-element flex items-center gap-2 border-t border-black/10">
			<div class="flex items-center gap-2 w-full" id="user-area"><button onclick="app.login()"
					class="w-full bg-discord-primary text-white py-2 rounded text-sm">Discord 登录</button></div>
		</div>
	</aside>

	<!-- Main Content -->
	<main class="flex-1 flex flex-col min-w-0 overflow-hidden relative bg-discord-bg">
		<!-- Header -->
		<header class="bg-discord-sidebar border-b border-black/10 p-3 md:p-4 shadow-sm z-20">
			<div class="flex flex-col gap-3">
				<div class="flex gap-2 items-center">
					<button class="md:hidden p-2 text-discord-muted hover:text-white -ml-2"
						onclick="app.toggleSidebar(true)">
						<span class="material-symbols-outlined">menu</span>
					</button>
					<div class="relative flex-1">
						<input
							class="w-full bg-discord-element text-white placeholder-discord-muted rounded px-4 py-2 pl-10 focus:outline-none focus:ring-2 focus:ring-discord-primary transition-all text-sm"
							id="search-input" placeholder="搜索关键词..." type="text">
						<span
							class="material-symbols-outlined absolute left-3 top-2 text-discord-muted text-[18px]">search</span>
					</div>
					<button
						class="bg-discord-primary hover:bg-discord-hover text-white px-4 py-2 rounded font-medium transition-colors text-sm shadow-md active:scale-95"
						onclick="app.executeSearch()">
						搜索
					</button>
				</div>
				<!-- Filters -->
				<div class="flex items-center gap-2 overflow-x-auto pb-1 hide-scrollbar text-xs md:text-sm">
					<div
						class="flex items-center gap-2 bg-discord-element px-2 py-1.5 rounded flex-shrink-0 border border-white/5">
						<span class="text-discord-muted material-symbols-outlined text-[16px]">calendar_today</span>
						<input class="bg-transparent text-white focus:outline-none w-20 md:w-auto" id="date-start"
							onchange="app.executeSearch()" type="date">
						<span class="text-discord-muted">-</span>
						<input class="bg-transparent text-white focus:outline-none w-20 md:w-auto" id="date-end"
							onchange="app.executeSearch()" type="date">
					</div>
					<div
						class="flex items-center gap-2 bg-discord-element px-2 py-1.5 rounded flex-shrink-0 border border-white/5">
						<span class="text-discord-muted material-symbols-outlined text-[16px]">sort</span>
						<select class="bg-transparent text-white focus:outline-none cursor-pointer appearance-none pr-2"
							id="sort-method" onchange="app.executeSearch()">
							<option value="comprehensive">综合排序</option>
							<option value="last_active">最近活跃</option>
							<option value="created_at">最新发布</option>
							<option value="reply_count">回复最多</option>
						</select>
					</div>
					<button
						class="p-1.5 rounded hover:bg-white/10 text-discord-muted hover:text-white transition-colors"
						id="sort-order-btn" onclick="app.toggleSortOrder()">
						<span class="material-symbols-outlined text-[18px]">arrow_downward</span>
					</button>
				</div>
			</div>
		</header>

		<!-- Content Scroll -->
		<div class="flex-1 overflow-y-auto p-3 md:p-6 scroll-smooth relative" id="content-scroll">
			<!-- Banner -->
			<div class="mb-6" id="banner-section">
				<div
					class="relative w-full h-40 md:h-64 rounded-xl overflow-hidden shadow-lg bg-discord-element border border-white/5">
					<div class="w-full h-full" id="banner-slides"><img src="https://placehold.co/1200x400/202225/5865F2"
							class="w-full h-full object-cover opacity-80"></div>
					<div
						class="absolute bottom-0 left-0 w-full h-2/3 bg-gradient-to-t from-discord-dark via-discord-dark/60 to-transparent p-4 flex flex-col justify-end pointer-events-none">
						<h2 class="text-lg md:text-2xl font-bold text-white mb-1 drop-shadow-md line-clamp-1"
							id="banner-title">Welcome</h2>
						<p class="text-xs text-gray-300 flex items-center gap-1"><span
								class="material-symbols-outlined text-xs text-yellow-400">star</span> 推荐</p>
					</div>
				</div>
			</div>

			<!-- Tags -->
			<div class="mb-4 hidden" id="tags-section">
				<div
					class="flex items-center gap-3 bg-discord-element px-3 py-2 rounded-lg w-full overflow-x-auto border border-white/5 mb-3">
					<button class="text-xs font-bold px-2 py-0.5 rounded bg-discord-primary text-white flex-shrink-0"
						id="logic-and" onclick="app.setTagLogic('and')">AND</button>
					<button
						class="text-xs font-bold px-2 py-0.5 rounded text-discord-muted hover:text-white flex-shrink-0"
						id="logic-or" onclick="app.setTagLogic('or')">OR</button>
					<div class="w-[1px] h-4 bg-white/10 mx-1"></div>
					<button
						class="flex items-center gap-1 text-xs px-2 py-0.5 rounded bg-discord-green/20 text-discord-green border border-discord-green flex-shrink-0"
						id="mode-include" onclick="app.setTagMode('include')">
						<span class="material-symbols-outlined text-[14px]">add</span> 包含
					</button>
					<button
						class="flex items-center gap-1 text-xs px-2 py-0.5 rounded text-discord-muted border border-transparent hover:border-discord-red hover:text-discord-red flex-shrink-0"
						id="mode-exclude" onclick="app.setTagMode('exclude')">
						<span class="material-symbols-outlined text-[14px]">block</span> 排除
					</button>
				</div>
				<div class="flex flex-wrap gap-2 max-h-24 overflow-y-auto" id="tag-cloud"><button
						onclick="app.handleTagClick('ui')"
						class="tag-pill text-xs px-2 py-1 rounded flex items-center gap-1 bg-discord-element border border-transparent text-discord-muted hover:border-gray-500">#ui</button><button
						onclick="app.handleTagClick('design')"
						class="tag-pill text-xs px-2 py-1 rounded flex items-center gap-1 bg-discord-element border border-transparent text-discord-muted hover:border-gray-500">#design</button><button
						onclick="app.handleTagClick('code')"
						class="tag-pill text-xs px-2 py-1 rounded flex items-center gap-1 bg-discord-element border border-transparent text-discord-muted hover:border-gray-500">#code</button>
				</div>
			</div>

			<!-- Results Header -->
			<div class="mb-4 flex items-center justify-between">
				<h2 class="text-lg font-semibold text-white flex items-center gap-2" id="view-title">搜索结果</h2>
				<div class="text-xs text-discord-muted" id="result-stats">找到 99 结果</div>
			</div>

			<!-- Results Grid -->
			<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6" id="results-grid"></div>

			<!-- Pagination -->
			<div class="mt-8 flex justify-center pb-10">
				<button
					class="px-8 py-2.5 bg-discord-element hover:bg-discord-sidebar rounded-full text-white font-medium transition-all disabled:opacity-50 shadow-lg border border-white/5"
					id="load-more-btn" onclick="app.loadMore()">加载更多</button>
			</div>
			<!-- Spinner -->
			<div class="mt-12 flex justify-center hidden" id="loading-spinner">
				<div class="animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-discord-primary"></div>
			</div>
		</div>
	</main>

	<script src="config.js"></script>
	<script src="script.js"></script>


</body>

</html>